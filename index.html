<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Estrategia de Resoluci√≥n Inversa ‚Äî Taller Interactivo</title>
    <meta
      name="description"
      content="Expo interactiva sobre la estrategia de resoluci√≥n inversa aplicada a problemas matem√°ticos. Con pasos, diagramas, actividades y quiz."
    />
    <style>
      :root {
        --bg: #0b0f14;
        --panel: #111827;
        --muted: #6b7280;
        --text: #e5e7eb;
        --brand: #22d3ee;
        --brand-2: #8b5cf6;
        --ok: #10b981;
        --warn: #f59e0b;
        --bad: #ef4444;
        --card: #0f172a;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI,
          Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
        background: radial-gradient(
            1200px 600px at 10% -10%,
            #102033 0%,
            transparent 60%
          ),
          radial-gradient(800px 500px at 110% -30%, #1a1030 0%, transparent 60%),
          var(--bg);
        color: var(--text);
      }
      a {
        color: var(--brand);
      }
      .container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 24px;
      }
      header.hero {
        position: relative;
        overflow: hidden;
        border-bottom: 1px solid #1f2937;
      }
      .hero-inner {
        display: grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap: 24px;
        align-items: center;
      }
      .title {
        font-size: clamp(24px, 4vw, 44px);
        line-height: 1.1;
        margin: 0;
      }
      .subtitle {
        color: var(--muted);
        margin-top: 8px;
      }
      .card {
        background: linear-gradient(145deg, #0c1420, #0a1018);
        border: 1px solid #1f2937;
        border-radius: 18px;
        box-shadow: var(--shadow);
      }
      .badge {
        display: inline-flex;
        gap: 6px;
        align-items: center;
        border: 1px solid #243041;
        background: #0a1220;
        border-radius: 999px;
        padding: 6px 10px;
        color: #93c5fd;
        font-size: 12px;
      }
      .pill {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        background: linear-gradient(
          90deg,
          rgba(34, 211, 238, 0.2),
          rgba(139, 92, 246, 0.2)
        );
        border: 1px solid rgba(148, 163, 184, 0.2);
        padding: 8px 12px;
        border-radius: 999px;
      }
      .row {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 16px;
      }
      .col-4 {
        grid-column: span 4;
      }
      .col-6 {
        grid-column: span 6;
      }
      .col-8 {
        grid-column: span 8;
      }
      .col-12 {
        grid-column: span 12;
      }

      /* Nav */
      .nav {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 16px;
      }
      .tab {
        cursor: pointer;
        border: 1px solid #1f2937;
        background: #0b1320;
        border-radius: 12px;
        padding: 10px 14px;
        color: #cbd5e1;
      }
      .tab.active {
        background: linear-gradient(
          90deg,
          rgba(34, 211, 238, 0.12),
          rgba(139, 92, 246, 0.12)
        );
        border-color: #334155;
        color: #e2e8f0;
      }

      /* Panels */
      .panel {
        display: none;
        margin-top: 18px;
      }
      .panel.active {
        display: block;
      }

      /* Stepper */
      .stepper {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }
      .step {
        position: relative;
        padding: 14px;
        border: 1px dashed #334155;
        border-radius: 14px;
        flex: 1 1 180px;
        background: linear-gradient(180deg, #0b1220, #0b0f14);
      }
      .step h4 {
        margin: 0 0 6px 0;
      }
      .step .n {
        display: inline-grid;
        place-items: center;
        width: 28px;
        height: 28px;
        border-radius: 8px;
        background: linear-gradient(135deg, #0ea5e9, #8b5cf6);
        font-weight: 700;
      }
      .step.active {
        border-style: solid;
        box-shadow: 0 0 0 2px rgba(34, 211, 238, 0.35) inset;
      }
      .step .hint {
        color: #93c5fd;
        font-size: 12px;
      }
      .controls {
        display: flex;
        gap: 12px;
        margin-top: 12px;
      }
      button {
        cursor: pointer;
        border: 1px solid #334155;
        background: #0c1420;
        color: #e5e7eb;
        border-radius: 12px;
        padding: 10px 14px;
      }
      button.primary {
        background: linear-gradient(90deg, #22d3ee, #8b5cf6);
        color: #0b0f14;
        border: 0;
        font-weight: 700;
      }
      button.ghost {
        background: transparent;
      }
      button.small {
        padding: 6px 10px;
        border-radius: 10px;
        font-size: 12px;
      }

      /* SVG Flow */
      .flow {
        width: 100%;
        height: auto;
      }
      .flow .node {
        cursor: pointer;
        transition: transform 0.15s ease;
      }
      .flow .node:hover {
        transform: translateY(-2px);
      }

      /* Cards */
      .cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 14px;
      }
      .card-inner {
        padding: 14px;
      }

      /* Modal */
      .modal {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        display: none;
        align-items: center;
        justify-content: center;
        padding: 16px;
      }
      .modal.show {
        display: flex;
      }
      .modal .box {
        max-width: 720px;
        width: 100%;
        background: #0b1320;
        border: 1px solid #1f2937;
        border-radius: 16px;
        box-shadow: var(--shadow);
      }
      .modal header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 16px;
        border-bottom: 1px solid #1f2937;
      }
      .modal .content {
        padding: 16px;
      }

      /* DnD */
      .dnd {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .dnd .bag,
      .dnd .target {
        min-height: 160px;
        border: 1px dashed #334155;
        border-radius: 12px;
        padding: 10px;
      }
      .chip {
        display: inline-block;
        margin: 6px;
        padding: 8px 10px;
        border-radius: 999px;
        border: 1px solid #334155;
        background: #0c1420;
      }

      /* Quiz */
      .question {
        padding: 14px;
        border: 1px solid #1f2937;
        border-radius: 14px;
        margin-bottom: 10px;
      }
      .choices {
        display: grid;
        gap: 8px;
        margin-top: 8px;
      }
      .choices label {
        display: flex;
        gap: 8px;
        align-items: flex-start;
        border: 1px dashed #334155;
        border-radius: 12px;
        padding: 10px;
      }

      /* Utilities */
      .muted {
        color: var(--muted);
      }
      .divider {
        height: 1px;
        background: #1f2937;
        margin: 18px 0;
      }
      .grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }
      .grid-3 {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
      }
      .kpi {
        padding: 12px;
        border-radius: 14px;
        background: linear-gradient(
          135deg,
          rgba(34, 211, 238, 0.1),
          rgba(139, 92, 246, 0.06)
        );
        border: 1px solid #334155;
      }

      @media (max-width: 900px) {
        .hero-inner {
          grid-template-columns: 1fr;
        }
        .grid-3 {
          grid-template-columns: 1fr;
        }
        .grid-2 {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header class="hero container">
      <div class="hero-inner">
        <div>
          <div class="badge">üîÅ Estrategias de Resoluci√≥n de Problemas</div>
          <h1 class="title">Resoluci√≥n Inversa (Working Backwards)</h1>
          <p class="subtitle">
            Bienvenidos a la secci√≥n de Resoluci√≥n Inversa (Working Backwards).
          </p>
          <div class="nav" role="tablist" aria-label="Secciones del taller">
            <button class="tab active" data-panel="intro">Introducci√≥n</button>
            <button class="tab" data-panel="teoria">Teor√≠a</button>
            <button class="tab" data-panel="estrategia">Metodolog√≠a</button>
            <button class="tab" data-panel="aplicacion">Aplicaci√≥n</button>
            <!-- <button class="tab" data-panel="practicar">Pr√°ctica</button>
            <button class="tab" data-panel="quiz">Evaluaci√≥n</button>
            <button class="tab" data-panel="recursos">Recursos</button> -->
          </div>
        </div>
          <div class="card-inner">
            <div class="divider"></div>
            <div class="pill">
              ‚ú® Consejo: si te atoras, piensa en el √∫ltimo paso y deshazlo.
            </div>
          </div>
        </div>
      </div>
    </header>

    <main class="container">
      <!-- INTRO -->
      <section id="intro" class="panel active">
        <div class="row">
          <div class="col-8">
            <div class="card">
              <div class="card-inner">
                <h2>üìö Introducci√≥n Te√≥rica a la Metodolog√≠a</h2>
                <p>
                  La <strong>resoluci√≥n inversa</strong> (Working Backwards) es
                  una estrategia heur√≠stica de resoluci√≥n de problemas que
                  invierte el proceso cognitivo tradicional. En lugar de partir
                  de los datos conocidos hacia lo desconocido, esta metodolog√≠a
                  comienza desde el <strong>objetivo final</strong> y construye
                  una cadena de razonamiento regresivo.
                </p>

                <h3>üßÆ Fundamento Matem√°tico</h3>
                <p>
                  El principio se basa en la
                  <strong>composici√≥n de funciones inversas</strong>: si tenemos
                  una secuencia de transformaciones f‚ÇÅ, f‚ÇÇ, f‚ÇÉ... que nos llevan
                  del estado inicial S‚ÇÄ al estado final S‚Çô, entonces aplicando
                  las inversas f‚ÇÉ‚Åª¬π, f‚ÇÇ‚Åª¬π, f‚ÇÅ‚Åª¬π en orden reverso, podemos
                  reconstruir el camino desde S‚Çô hacia S‚ÇÄ.
                </p>

                <div class="pill">
                  üéØ <strong>Principio clave:</strong> La reversibilidad de las
                  operaciones permite la navegaci√≥n bidireccional en el espacio
                  de estados
                </div>

                <h3>üîÑ Visualizaci√≥n del Proceso Cognitivo</h3>
                <svg
                  class="flow"
                  viewBox="0 0 880 180"
                  aria-label="Diagrama de flujo de la estrategia"
                >
                  <defs>
                    <linearGradient id="g1" x1="0" x2="1">
                      <stop offset="0%" stop-color="#22d3ee" />
                      <stop offset="100%" stop-color="#8b5cf6" />
                    </linearGradient>
                  </defs>
                  <g>
                    <rect
                      x="20"
                      y="40"
                      width="180"
                      height="60"
                      rx="12"
                      fill="#0b1320"
                      stroke="#334155"
                    />
                    <text x="110" y="75" fill="#e5e7eb" text-anchor="middle">
                      Meta
                    </text>

                    <rect
                      class="node"
                      data-node="retro1"
                      x="240"
                      y="40"
                      width="180"
                      height="60"
                      rx="12"
                      fill="#0b1320"
                      stroke="#334155"
                    />
                    <text x="330" y="75" fill="#e5e7eb" text-anchor="middle">
                      Paso previo
                    </text>

                    <rect
                      class="node"
                      data-node="retro2"
                      x="460"
                      y="40"
                      width="180"
                      height="60"
                      rx="12"
                      fill="#0b1320"
                      stroke="#334155"
                    />
                    <text x="550" y="75" fill="#e5e7eb" text-anchor="middle">
                      Paso previo
                    </text>

                    <rect
                      x="680"
                      y="40"
                      width="180"
                      height="60"
                      rx="12"
                      fill="#0b1320"
                      stroke="#334155"
                    />
                    <text x="770" y="75" fill="#e5e7eb" text-anchor="middle">
                      Inicio
                    </text>

                    <path d="M200 70 H240" stroke="url(#g1)" stroke-width="3" />
                    <path d="M420 70 H460" stroke="url(#g1)" stroke-width="3" />
                    <path d="M640 70 H680" stroke="url(#g1)" stroke-width="3" />
                  </g>
                </svg>
                <p class="muted">
                  Haz clic en los bloques morados para ver ejemplos detallados ÔøΩ
                </p>
              </div>
            </div>
          </div>
          <div class="col-4">
            <div class="card">
              <div class="card-inner">
                <h3>üéì Marco Conceptual</h3>
                <p class="muted">
                  La resoluci√≥n inversa forma parte de las
                  <strong>estrategias heur√≠sticas</strong> en la resoluci√≥n de
                  problemas, junto con:
                </p>
                <ul>
                  <li>
                    üí° <strong>Analog√≠a:</strong> Usar problemas similares
                  </li>
                  <li>üîÄ <strong>Divide y vencer√°s:</strong> Descomposici√≥n</li>
                  <li>
                    üîç <strong>Ensayo y error:</strong> B√∫squeda sistem√°tica
                  </li>
                  <li>
                    üéØ <strong>Working backwards:</strong> Razonamiento
                    regresivo
                  </li>
                </ul>

                <h3>‚ö° Ventaja Cognitiva Principal</h3>
                <p>
                  Reduce la <em>carga cognitiva</em> al eliminar caminos
                  irrelevantes desde el inicio, focalizando todos los recursos
                  mentales en la construcci√≥n de una ruta directa hacia el
                  objetivo.
                </p>

                <div class="divider"></div>
                <button id="btnDemo" class="primary">
                  Ver una demo guiada
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- TEOR√çA -->
      <section id="teoria" class="panel">
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-inner">
                <h2>üß† Fundamentos Te√≥ricos</h2>

                <div class="grid-2" style="margin-bottom: 20px">
                  <div>
                    <h3>Definici√≥n Formal</h3>
                    <p>
                      La <strong>resoluci√≥n inversa</strong> es un m√©todo
                      heur√≠stico que opera mediante el
                      <em>razonamiento regresivo</em>, partiendo del estado meta
                      y aplicando sistem√°ticamente las operaciones inversas
                      hasta alcanzar el estado inicial conocido o desconocido.
                    </p>
                  </div>
                  <div>
                    <h3>Base Matem√°tica</h3>
                    <p>
                      Se fundamenta en la
                      <strong>propiedad de reversibilidad</strong> de las
                      operaciones matem√°ticas y la
                      <strong>composici√≥n de funciones inversas</strong>: si
                      f(x) = y, entonces f‚Åª¬π(y) = x.
                    </p>
                  </div>
                </div>

                <div class="divider"></div>

                <h3>üéØ Ventajas de la Estrategia</h3>
                <div class="cards">
                  <div class="card">
                    <div class="card-inner">
                      <h4>‚ú® Claridad de objetivo</h4>
                      <p>
                        Al partir de la meta, mantienes siempre clara la
                        direcci√≥n hacia donde te diriges.
                      </p>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>‚ö° Eficiencia cognitiva</h4>
                      <p>
                        Reduce la carga mental al eliminar caminos irrelevantes
                        o innecesarios.
                      </p>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>üîç Simplificaci√≥n</h4>
                      <p>
                        Convierte problemas complejos en una serie de pasos m√°s
                        manejables.
                      </p>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>üé≤ Versatilidad</h4>
                      <p>
                        Aplicable a m√∫ltiples dominios: matem√°ticas, l√≥gica,
                        programaci√≥n, vida cotidiana.
                      </p>
                    </div>
                  </div>
                </div>

                <div class="divider"></div>

                <h3>üéØ An√°lisis Ventajas vs Limitaciones</h3>
                <div class="grid-2">
                  <div class="card">
                    <div class="card-inner">
                      <h4>‚úÖ Fortalezas Principales</h4>
                      <ul>
                        <li>
                          <strong>Eficiencia cognitiva:</strong> Elimina caminos
                          irrelevantes
                        </li>
                        <li>
                          <strong>Claridad direccional:</strong> Mantiene el
                          objetivo siempre visible
                        </li>
                        <li>
                          <strong>Reducci√≥n de complejidad:</strong> Convierte
                          problemas grandes en pasos manejables
                        </li>
                        <li>
                          <strong>Aplicabilidad amplia:</strong> M√∫ltiples
                          dominios del conocimiento
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>‚ùå Restricciones Inherentes</h4>
                      <ul>
                        <li>
                          <strong>Reversibilidad requerida:</strong> No todas
                          las operaciones son invertibles
                        </li>
                        <li>
                          <strong>Meta bien definida:</strong> Necesita
                          objetivos claros y espec√≠ficos
                        </li>
                        <li>
                          <strong>Limitaci√≥n estoc√°stica:</strong> No funciona
                          con procesos aleatorios
                        </li>
                        <li>
                          <strong>Carga cognitiva inicial:</strong> Requiere
                          pensamiento abstracto
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row" style="margin-top: 16px">
          <div class="col-12">
            <div class="card">
              <div class="card-inner">
                <h3>üßÆ An√°lisis Comparativo de Estrategias Heur√≠sticas</h3>
                <p class="muted">
                  La resoluci√≥n inversa se distingue de otras metodolog√≠as por
                  su enfoque orientado al objetivo:
                </p>

                <div class="grid-2" style="margin-top: 16px">
                  <div class="card">
                    <div class="card-inner">
                      <h4>üéØ Resoluci√≥n Inversa</h4>
                      <ul>
                        <li>‚úÖ <strong>Direcci√≥n:</strong> Meta ‚Üí Inicio</li>
                        <li>
                          ‚úÖ <strong>Enfoque:</strong> Orientado al objetivo
                        </li>
                        <li>
                          ‚úÖ <strong>Requisito:</strong> Operaciones reversibles
                        </li>
                        <li>
                          ‚úÖ <strong>Fortaleza:</strong> Reduce el espacio de
                          b√∫squeda
                        </li>
                        <li>
                          ‚ùå <strong>Limitaci√≥n:</strong> Requiere meta bien
                          definida
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>üîÄ Otras Estrategias</h4>
                      <ul>
                        <li>
                          <strong>Ensayo y error:</strong> Exploraci√≥n aleatoria
                        </li>
                        <li>
                          <strong>Divide y vencer√°s:</strong> Descomposici√≥n
                          recursiva
                        </li>
                        <li>
                          <strong>Analog√≠a:</strong> Transferencia de
                          conocimiento
                        </li>
                        <li>
                          <strong>Fuerza bruta:</strong> Exploraci√≥n exhaustiva
                        </li>
                        <li>
                          <strong>Programaci√≥n din√°mica:</strong> Subproblemas
                          √≥ptimos
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="divider"></div>

                <h3>üß† Modelo Cognitivo</h3>
                <p>El proceso mental involucra tres fases clave:</p>
                <div class="stepper">
                  <div class="step">
                    <div class="n">1</div>
                    <h4>Representaci√≥n mental</h4>
                    <div class="hint">Visualizar claramente el estado meta</div>
                  </div>
                  <div class="step">
                    <div class="n">2</div>
                    <h4>Transformaci√≥n regresiva</h4>
                    <div class="hint">
                      Aplicar operaciones inversas sistem√°ticamente
                    </div>
                  </div>
                  <div class="step">
                    <div class="n">3</div>
                    <h4>Validaci√≥n progresiva</h4>
                    <div class="hint">
                      Verificar la ruta construida hacia adelante
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ESTRATEGIA (METODOLOG√çA) -->
      <section id="estrategia" class="panel">
        <div class="card">
          <div class="card-inner">
            <h2>üìã Metodolog√≠a: Pasos de la Estrategia</h2>
            <div class="stepper" id="stepper">
              <div class="step active" data-step="1">
                <div class="n">1</div>
                <h4>Define la meta</h4>
                <div class="hint">¬øQu√© quieres al final?</div>
              </div>
              <div class="step" data-step="2">
                <div class="n">2</div>
                <h4>Describe el estado previo</h4>
                <div class="hint">¬øQu√© deb√≠a ser cierto justo antes?</div>
              </div>
              <div class="step" data-step="3">
                <div class="n">3</div>
                <h4>Invierte la operaci√≥n</h4>
                <div class="hint">Deshaz lo que te llev√≥ a la meta.</div>
              </div>
              <div class="step" data-step="4">
                <div class="n">4</div>
                <h4>Itera hacia atr√°s</h4>
                <div class="hint">Repite hasta llegar al inicio.</div>
              </div>
              <div class="step" data-step="5">
                <div class="n">5</div>
                <h4>Verifica hacia adelante</h4>
                <div class="hint">Simula del inicio a la meta.</div>
              </div>
            </div>
            <div class="controls">
              <button class="ghost" id="prev">‚óÄ Anterior</button>
              <button class="primary" id="next">Siguiente ‚ñ∂</button>
              <button class="ghost small" id="resetStepper">Reiniciar</button>
            </div>
          </div>
        </div>

        <div class="row" style="margin-top: 14px">
          <div class="col-6">
            <div class="card">
              <div class="card-inner">
                <h3>Diagrama secuencial</h3>
                <ol id="seqList">
                  <li>üß≠ Meta: <em>llegar a 20 caramelos</em>.</li>
                  <li>‚Ü© Estado previo: <em>despu√©s de sumar 5</em>.</li>
                  <li>‚§ø Invertir: <em>restar 5</em> ‚áí 15.</li>
                  <li>
                    ‚§ø Invertir: <em>doblar al rev√©s = mitad</em> ‚áí 7.5 (ajustar
                    si el contexto exige enteros).
                  </li>
                  <li>
                    ‚úÖ Verificar: aplicar pasos originales y comprobar 20.
                  </li>
                </ol>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div class="card">
              <div class="card-inner">
                <h3>Ordena los pasos (Drag & Drop)</h3>
                <div class="dnd">
                  <div
                    class="bag"
                    id="bag"
                    aria-label="Pasos desordenados"
                  ></div>
                  <div
                    class="target"
                    id="target"
                    aria-label="Orden correcto"
                  ></div>
                </div>
                <div class="controls">
                  <button id="checkOrder" class="primary">Comprobar</button>
                  <span id="orderMsg" class="muted"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- APLICACI√ìN -->
      <section id="aplicacion" class="panel">
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-inner">
                <h2>üöÄ Aplicaciones de la Resoluci√≥n Inversa</h2>

                <div
                  class="card"
                  style="
                    background: linear-gradient(
                      135deg,
                      rgba(34, 211, 238, 0.05),
                      rgba(139, 92, 246, 0.05)
                    );
                    margin-bottom: 20px;
                  "
                >
                  <div class="card-inner">
                    <h3>üèóÔ∏è Taxonom√≠a de Problemas Ideales</h3>
                    <div class="grid-3">
                      <div class="card">
                        <div class="card-inner">
                          <h4>üßÆ Problemas Algebraicos</h4>
                          <ul>
                            <li>Ecuaciones de primer y segundo grado</li>
                            <li>Sistemas de ecuaciones lineales</li>
                            <li>Factorizaciones polin√≥micas</li>
                            <li>Problemas de proporcionalidad</li>
                          </ul>
                        </div>
                      </div>
                      <div class="card">
                        <div class="card-inner">
                          <h4>‚ö° Problemas de Optimizaci√≥n</h4>
                          <ul>
                            <li>Rutas m√°s cortas o eficientes</li>
                            <li>Asignaci√≥n √≥ptima de recursos</li>
                            <li>Planificaci√≥n temporal (PERT/CPM)</li>
                            <li>Problemas de minimizaci√≥n de costos</li>
                          </ul>
                        </div>
                      </div>
                      <div class="card">
                        <div class="card-inner">
                          <h4>üîç Problemas L√≥gicos</h4>
                          <ul>
                            <li>Deducciones e inferencias</li>
                            <li>Condicionales encadenados</li>
                            <li>√Årboles de decisi√≥n</li>
                            <li>Pruebas por contradicci√≥n</li>
                          </ul>
                        </div>
                      </div>
                    </div>

                    <div class="divider"></div>
                    <p class="muted">
                      <strong>Criterio com√∫n:</strong> Todos estos tipos
                      comparten la caracter√≠stica de tener operaciones
                      <em>reversibles</em> y un objetivo
                      <em>claramente definido</em>.
                    </p>
                  </div>
                </div>

                <div class="cards">
                  <article class="card">
                    <div class="card-inner">
                      <h3>üßÆ Matem√°ticas</h3>
                      <ul>
                        <li>
                          <strong>√Ålgebra:</strong> Resolver ecuaciones,
                          sistemas lineales
                        </li>
                        <li>
                          <strong>Geometr√≠a:</strong> Construcciones
                          geom√©tricas, demostraciones
                        </li>
                        <li>
                          <strong>Aritm√©tica:</strong> Problemas de edad,
                          distancia, tiempo
                        </li>
                        <li>
                          <strong>C√°lculo:</strong> Optimizaci√≥n, derivadas e
                          integrales
                        </li>
                      </ul>
                    </div>
                  </article>

                  <article class="card">
                    <div class="card-inner">
                      <h3>üíª Programaci√≥n e Inform√°tica</h3>
                      <ul>
                        <li>
                          <strong>Algoritmos:</strong> B√∫squeda hacia atr√°s,
                          backtracking
                        </li>
                        <li>
                          <strong>Debugging:</strong> Rastrear errores desde el
                          s√≠ntoma
                        </li>
                        <li>
                          <strong>Dise√±o:</strong> Arquitectura de software
                          orientada a objetivos
                        </li>
                        <li>
                          <strong>IA:</strong> Planificaci√≥n autom√°tica,
                          sistemas expertos
                        </li>
                      </ul>
                    </div>
                  </article>

                  <article class="card">
                    <div class="card-inner">
                      <h3>üéØ Planificaci√≥n y Gesti√≥n</h3>
                      <ul>
                        <li>
                          <strong>Proyectos:</strong> Cronogramas, hitos,
                          dependencias
                        </li>
                        <li>
                          <strong>Presupuestos:</strong> Objetivos financieros,
                          metas de ahorro
                        </li>
                        <li>
                          <strong>Log√≠stica:</strong> Rutas √≥ptimas, cadenas de
                          suministro
                        </li>
                        <li>
                          <strong>Estrategia:</strong> Objetivos
                          organizacionales, KPIs
                        </li>
                      </ul>
                    </div>
                  </article>

                  <article class="card">
                    <div class="card-inner">
                      <h3>üî¨ Ciencias</h3>
                      <ul>
                        <li>
                          <strong>F√≠sica:</strong> An√°lisis de trayectorias,
                          conservaci√≥n
                        </li>
                        <li>
                          <strong>Qu√≠mica:</strong> S√≠ntesis org√°nica, an√°lisis
                          retrosint√©tico
                        </li>
                        <li>
                          <strong>Biolog√≠a:</strong> Evoluci√≥n, √°rboles
                          filogen√©ticos
                        </li>
                        <li>
                          <strong>Medicina:</strong> Diagn√≥stico diferencial
                        </li>
                      </ul>
                    </div>
                  </article>
                </div>

                <div class="divider"></div>

                <h3>üìã Casos de Estudio Detallados</h3>
                <div class="row">
                  <div class="col-6">
                    <div class="card">
                      <div class="card-inner">
                        <h4>Caso 1: Planificaci√≥n de Viaje</h4>
                        <p>
                          <strong>Objetivo:</strong> Llegar a Par√≠s el 15 de
                          diciembre a las 10:00 AM
                        </p>

                        <div class="stepper">
                          <div class="step active">
                            <div class="n">üéØ</div>
                            <h4>Meta</h4>
                            <div class="hint">Par√≠s, 15/12, 10:00 AM</div>
                          </div>
                          <div class="step">
                            <div class="n">‚úàÔ∏è</div>
                            <h4>Vuelo</h4>
                            <div class="hint">
                              Salida 14/12, 11:00 PM (11h vuelo)
                            </div>
                          </div>
                          <div class="step">
                            <div class="n">üöó</div>
                            <h4>Traslado</h4>
                            <div class="hint">Salir de casa 14/12, 8:00 PM</div>
                          </div>
                          <div class="step">
                            <div class="n">üß≥</div>
                            <h4>Preparaci√≥n</h4>
                            <div class="hint">
                              Empacar 13/12, documentos listos
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-6">
                    <div class="card">
                      <div class="card-inner">
                        <h4>Caso 2: Desarrollo de Software</h4>
                        <p>
                          <strong>Objetivo:</strong> App m√≥vil funcionando en
                          producci√≥n
                        </p>

                        <div class="stepper">
                          <div class="step active">
                            <div class="n">üì±</div>
                            <h4>Producci√≥n</h4>
                            <div class="hint">
                              App en tiendas, usuarios activos
                            </div>
                          </div>
                          <div class="step">
                            <div class="n">üß™</div>
                            <h4>Testing</h4>
                            <div class="hint">
                              QA, beta testing, correcci√≥n de bugs
                            </div>
                          </div>
                          <div class="step">
                            <div class="n">‚öôÔ∏è</div>
                            <h4>Desarrollo</h4>
                            <div class="hint">
                              C√≥digo, integraci√≥n, features
                            </div>
                          </div>
                          <div class="step">
                            <div class="n">üìê</div>
                            <h4>Dise√±o</h4>
                            <div class="hint">
                              UX/UI, arquitectura, requisitos
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="divider"></div>

                <h3>üõ†Ô∏è Herramientas y T√©cnicas de Apoyo</h3>
                <div class="grid-3">
                  <div class="card">
                    <div class="card-inner">
                      <h4>üóÇÔ∏è Diagramas de Flujo Inverso</h4>
                      <p>
                        Representaci√≥n visual del proceso desde la meta hasta el
                        inicio
                      </p>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>üìã Listas de Verificaci√≥n</h4>
                      <p>
                        Checklist para validar cada paso del proceso inverso
                      </p>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-inner">
                      <h4>üîÑ Tablas de Inversi√≥n</h4>
                      <p>
                        Correspondencia entre operaciones directas e inversas
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- PRACTICAR -->
      <section id="practicar" class="panel">
        <div class="card">
          <div class="card-inner">
            <h2>üí™ Pr√°ctica Interactiva</h2>
            <p>
              Pon a prueba tus conocimientos con estos problemas dise√±ados
              espec√≠ficamente para aplicar la resoluci√≥n inversa. Cada ejercicio
              incluye una gu√≠a paso a paso.
            </p>
          </div>
        </div>
        <div class="cards">
          <article class="card problem" data-problem="canicas">
            <div class="card-inner">
              <h3>Canicas en un cofre</h3>
              <p class="muted">
                Al final quedan <strong>9</strong> canicas. Justo antes, se
                <em>sumaron 3</em>. Antes de eso, se <em>duplic√≥</em> el n√∫mero.
                ¬øCu√°ntas hab√≠a al inicio?
              </p>
              <button class="primary open">Resolver</button>
            </div>
          </article>
          <article class="card problem" data-problem="pizzas">
            <div class="card-inner">
              <h3>Rebanadas de pizza</h3>
              <p class="muted">
                Al final hay <strong>26</strong> rebanadas. Antes, se
                <em>sumaron 2</em>. Antes, se <em>triplic√≥</em>. ¬øCu√°ntas hab√≠a
                al inicio?
              </p>
              <button class="primary open">Resolver</button>
            </div>
          </article>
          <article class="card problem" data-problem="sendero">
            <div class="card-inner">
              <h3>Sendero con peajes</h3>
              <p class="muted">
                Llegas con <strong>$17</strong>. Antes pagaste <em>$5</em>.
                Antes, te descontaron la <em>mitad</em>. ¬øCon cu√°nto empezaste?
              </p>
              <button class="primary open">Resolver</button>
            </div>
          </article>
          <article class="card problem" data-problem="custom">
            <div class="card-inner">
              <h3>Crea tu propio problema</h3>
              <p class="muted">
                Define la meta y las operaciones finales, y deja que el
                asistente invierta los pasos contigo.
              </p>
              <button class="primary open">Configurar</button>
            </div>
          </article>
        </div>
      </section>

      <!-- QUIZ -->
      <section id="quiz" class="panel">
        <div class="card">
          <div class="card-inner">
            <h2>üìä Evaluaci√≥n: Quiz Interactivo</h2>
            <p>
              Eval√∫a tu comprensi√≥n de la resoluci√≥n inversa con estas preguntas
              cuidadosamente dise√±adas.
            </p>
            <div class="question" data-answer="c">
              <div>
                <strong>1.</strong> ¬øCu√°l es la primera acci√≥n al aplicar
                resoluci√≥n inversa?
              </div>
              <div class="choices">
                <label
                  ><input type="radio" name="q1" value="a" /> Probar n√∫meros al
                  azar.</label
                >
                <label
                  ><input type="radio" name="q1" value="b" /> Ejecutar las
                  operaciones hacia adelante.</label
                >
                <label
                  ><input type="radio" name="q1" value="c" /> Definir con
                  claridad la meta.</label
                >
              </div>
            </div>
            <div class="question" data-answer="b">
              <div>
                <strong>2.</strong> Si el √∫ltimo paso fue "sumar 7", la
                inversi√≥n correcta es‚Ä¶
              </div>
              <div class="choices">
                <label
                  ><input type="radio" name="q2" value="a" /> Dividir entre
                  7.</label
                >
                <label
                  ><input type="radio" name="q2" value="b" /> Restar 7.</label
                >
                <label
                  ><input type="radio" name="q2" value="c" /> Multiplicar por
                  7.</label
                >
              </div>
            </div>
            <div class="question" data-answer="a">
              <div>
                <strong>3.</strong> ¬øQu√© paso valida que no cometiste errores al
                invertir?
              </div>
              <div class="choices">
                <label
                  ><input type="radio" name="q3" value="a" /> Verificar hacia
                  adelante.</label
                >
                <label
                  ><input type="radio" name="q3" value="b" /> Adivinar y
                  ajustar.</label
                >
                <label
                  ><input type="radio" name="q3" value="c" /> Comparar con otra
                  estrategia.</label
                >
              </div>
            </div>
            <div class="controls">
              <button id="grade" class="primary">Calificar</button>
              <span id="score" class="muted"></span>
              <button id="saveProgress" class="ghost small">
                Guardar progreso
              </button>
              <button id="loadProgress" class="ghost small">
                Cargar progreso
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- RECURSOS -->
      <section id="recursos" class="panel">
        <div class="card">
          <div class="card-inner">
            <h2>üìö Recursos y Material Complementario</h2>

            <div class="row">
              <div class="col-8">
                <h3>üîß Plantilla de Trabajo Inverso</h3>
                <div class="card" style="background: #0a1018">
                  <div class="card-inner">
                    <ol>
                      <li>
                        <strong>Meta</strong> (resultado final):
                        <em>Describe claramente el estado objetivo‚Ä¶</em>
                      </li>
                      <li>
                        <strong>Operaci√≥n final:</strong>
                        <em>¬øQu√© se hizo √∫ltimo?</em> ‚Üí
                        <strong>Inversa:</strong> <em>¬øC√≥mo deshacerlo?</em>
                      </li>
                      <li>
                        <strong>Estado previo 1:</strong>
                        <em>¬øC√≥mo estaba antes de la operaci√≥n final?</em>
                      </li>
                      <li>
                        <strong>Operaci√≥n previa:</strong>
                        <em>¬øQu√© se hizo antes?</em> ‚Üí
                        <strong>Inversa:</strong> <em>¬øC√≥mo deshacerlo?</em>
                      </li>
                      <li>
                        <strong>Estado inicial:</strong>
                        <em>Valor o condici√≥n de partida</em>
                      </li>
                      <li>
                        <strong>Verificaci√≥n:</strong>
                        <em
                          >Ejecuta hacia adelante y confirma que llegas a la
                          meta</em
                        >
                      </li>
                    </ol>
                    <button id="exportJSON" class="primary">
                      üìÅ Exportar plantilla (.json)
                    </button>
                  </div>
                </div>
              </div>

              <div class="col-4">
                <h3>üí° Consejos Avanzados</h3>
                <ul>
                  <li>
                    üîç Si aparecen <strong>fracciones</strong> al invertir,
                    revisa el contexto del problema
                  </li>
                  <li>
                    üìù <strong>Documenta</strong> cada inversi√≥n con su
                    justificaci√≥n matem√°tica
                  </li>
                  <li>
                    ‚úÖ <strong>Verifica siempre</strong> ejecutando los pasos
                    hacia adelante
                  </li>
                  <li>
                    üéØ Mant√©n la <strong>meta visible</strong> durante todo el
                    proceso
                  </li>
                  <li>
                    üîÑ Si te atascas, <strong>revisa</strong> si todas las
                    operaciones son realmente reversibles
                  </li>
                </ul>
              </div>
            </div>

            <div class="divider"></div>

            <h3>üìñ Bibliograf√≠a y Referencias</h3>
            <div class="cards">
              <div class="card">
                <div class="card-inner">
                  <h4>üìö Libros de referencia</h4>
                  <ul>
                    <li>"How to Solve It" - George P√≥lya</li>
                    <li>"Mathematical Problem Solving" - Alan Schoenfeld</li>
                    <li>"The Art of Problem Solving" - Richard Rusczyk</li>
                  </ul>
                </div>
              </div>
              <div class="card">
                <div class="card-inner">
                  <h4>üåê Recursos online</h4>
                  <ul>
                    <li>Khan Academy - Problem Solving Strategies</li>
                    <li>MIT OpenCourseWare - Mathematics</li>
                    <li>Coursera - Mathematical Thinking</li>
                  </ul>
                </div>
              </div>
              <div class="card">
                <div class="card-inner">
                  <h4>üèÜ Competencias matem√°ticas</h4>
                  <ul>
                    <li>Olimpiada Matem√°tica Nacional</li>
                    <li>
                      AIME (American Invitational Mathematics Examination)
                    </li>
                    <li>IMO (International Mathematical Olympiad)</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="divider"></div>

            <h3>‚öôÔ∏è Herramientas Interactivas</h3>
            <div class="grid-3">
              <button id="toggleTheme" class="card">
                <div class="card-inner">
                  <h4>üåó Cambiar tema</h4>
                  <p>Alterna entre modo claro y oscuro</p>
                </div>
              </button>
              <button class="card" onclick="window.print()">
                <div class="card-inner">
                  <h4>üñ®Ô∏è Imprimir</h4>
                  <p>Genera una versi√≥n para imprimir</p>
                </div>
              </button>
              <button
                class="card"
                onclick="navigator.share && navigator.share({title: 'Resoluci√≥n Inversa', url: window.location.href})"
              >
                <div class="card-inner">
                  <h4>üì§ Compartir</h4>
                  <p>Comparte esta exposici√≥n</p>
                </div>
              </button>
            </div>

            <div class="divider"></div>

            <div
              class="card"
              style="
                background: linear-gradient(
                  135deg,
                  rgba(34, 211, 238, 0.1),
                  rgba(139, 92, 246, 0.1)
                );
              "
            >
              <div class="card-inner">
                <h3>ÔøΩ Para el educador</h3>
                <p>Esta exposici√≥n interactiva puede ser utilizada como:</p>
                <ul>
                  <li>
                    üì± <strong>Material de clase:</strong> Proyectar durante la
                    explicaci√≥n
                  </li>
                  <li>
                    üìö <strong>Tarea interactiva:</strong> Los estudiantes
                    pueden explorar a su ritmo
                  </li>
                  <li>
                    üî¨ <strong>Laboratorio virtual:</strong> Experimentar con
                    problemas personalizados
                  </li>
                  <li>
                    üìä <strong>Herramienta de evaluaci√≥n:</strong> Quiz
                    integrado con seguimiento de progreso
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- MODAL -->
    <div class="modal" id="modal">
      <div class="box">
        <header>
          <strong id="modalTitle">Resolver</strong>
          <button id="closeModal">‚úï</button>
        </header>
        <div class="content" id="modalContent"></div>
      </div>
    </div>

    <script>
      // ===== Navegaci√≥n por pesta√±as =====
      const tabs = document.querySelectorAll(".tab");
      const panels = document.querySelectorAll(".panel");
      tabs.forEach((t) =>
        t.addEventListener("click", () => {
          tabs.forEach((x) => x.classList.remove("active"));
          t.classList.add("active");
          panels.forEach((p) => p.classList.remove("active"));
          document.getElementById(t.dataset.panel).classList.add("active");
        })
      );

      // ===== Stepper =====
      const stepper = document.getElementById("stepper");
      const steps = [...stepper.querySelectorAll(".step")];
      let idx = 0;
      const setActive = (i) => {
        steps.forEach((s) => s.classList.remove("active"));
        steps[i].classList.add("active");
      };
      document.getElementById("next").onclick = () => {
        idx = Math.min(idx + 1, steps.length - 1);
        setActive(idx);
      };
      document.getElementById("prev").onclick = () => {
        idx = Math.max(idx - 1, 0);
        setActive(idx);
      };
      document.getElementById("resetStepper").onclick = () => {
        idx = 0;
        setActive(idx);
      };

      // ===== Flow nodes demo =====
      document.querySelectorAll(".flow .node").forEach((n) => {
        n.addEventListener("click", () => {
          openModal(
            "Ejemplo breve",
            `<p>Imagina que la meta es <strong>40</strong>. Si lo √∫ltimo fue 
        <em>sumar 8</em>, el estado previo era <strong>32</strong>. Si antes se <em>duplic√≥</em>, 
        entonces el estado anterior era <strong>16</strong>. As√≠ retrocedes hasta el inicio.</p>`
          );
        });
      });
      document.getElementById("btnDemo").onclick = () => {
        openModal(
          "Demo guiada",
          `<ol>
        <li>Meta: 20.</li>
        <li>√öltimo paso: +5 ‚áí inversa: ‚àí5 ‚Üí 15.</li>
        <li>Pen√∫ltimo: √ó2 ‚áí inversa: √∑2 ‚Üí 7.5.</li>
        <li>Repite hasta llegar a un inicio coherente con el contexto.</li>
        <li>Verifica hacia adelante.</li>
      </ol>`
        );
      };

      // ===== Drag & Drop de pasos =====
      const bag = document.getElementById("bag");
      const target = document.getElementById("target");
      const pasos = [
        "Define la meta",
        "Describe el estado previo",
        "Invierte la operaci√≥n",
        "Itera hacia atr√°s",
        "Verifica hacia adelante",
      ];
      function shuffle(a) {
        for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      }
      function renderDnD() {
        bag.innerHTML = "";
        target.innerHTML = "";
        shuffle([...pasos]).forEach((txt, i) => {
          const el = document.createElement("div");
          el.textContent = txt;
          el.className = "chip";
          el.draggable = true;
          el.id = "chip-" + i;
          el.addEventListener("dragstart", (ev) => {
            ev.dataTransfer.setData("text/plain", txt);
          });
          bag.appendChild(el);
        });
        [bag, target].forEach((box) => {
          box.addEventListener("dragover", (ev) => ev.preventDefault());
          box.addEventListener("drop", (ev) => {
            ev.preventDefault();
            const txt = ev.dataTransfer.getData("text/plain");
            const chip = document.createElement("div");
            chip.textContent = txt;
            chip.className = "chip";
            box.appendChild(chip);
          });
        });
      }
      renderDnD();
      document.getElementById("checkOrder").onclick = () => {
        const chosen = [...target.querySelectorAll(".chip")].map((x) =>
          x.textContent.trim()
        );
        const ok = JSON.stringify(chosen) === JSON.stringify(pasos);
        document.getElementById("orderMsg").textContent = ok
          ? "‚úÖ ¬°Perfecto!"
          : "‚ùå A√∫n no. Intenta reorganizar.";
      };

      // ===== Problemas guiados =====
      const problems = {
        canicas: {
          title: "Canicas en un cofre",
          goal: 9,
          steps: [
            { op: "+3", inv: "-3" },
            { op: "√ó2", inv: "√∑2" },
          ],
          context: "Enteros no negativos",
        },
        pizzas: {
          title: "Rebanadas de pizza",
          goal: 26,
          steps: [
            { op: "+2", inv: "-2" },
            { op: "√ó3", inv: "√∑3" },
          ],
          context: "Enteros",
        },
        sendero: {
          title: "Sendero con peajes",
          goal: 17,
          steps: [
            { op: "-5", inv: "+5" },
            { op: "mitad", inv: "√ó2" },
          ],
          context: "Reales",
        },
      };

      function renderSolver(cfg) {
        const html = `
        <p><strong>Meta</strong>: ${cfg.goal}</p>
        <p>Invierte los pasos uno por uno:</p>
        <ol id="invList">${cfg.steps
          .map(
            (s, i) =>
              `<li>√öltimo fue <code>${s.op}</code> ‚Üí inversa: <input data-i="${i}" size="4" placeholder="?"> </li>`
          )
          .join("")}</ol>
        <div class="divider"></div>
        <label>Resultado al invertir todo: <input id="startGuess" type="number" placeholder="Inicio"></label>
        <div class="controls"><button id="checkSolver" class="primary">Comprobar</button><span id="solverMsg" class="muted"></span></div>
      `;
        openModal("Resoluci√≥n guiada", html);
        document.getElementById("checkSolver").onclick = () => {
          const inputs = [...document.querySelectorAll("#invList input")];
          const okOps = inputs.every(
            (inp, i) => inp.value.replaceAll(" ", "") === cfg.steps[i].inv
          );
          // calcular inicio real
          let x = cfg.goal;
          cfg.steps.forEach((s) => {
            // aplicar inversas declaradas
            if (s.inv.startsWith("-")) x += parseFloat(s.inv.slice(1)) * -1; // no se usa
          });
          // Mejor: calcular por las inversas conocidas en cfg
          let start = cfg.goal;
          cfg.steps.forEach((s) => {
            const inv = s.inv;
            if (inv.startsWith("-")) {
              start = start - parseFloat(inv.slice(1));
            } // (inv de +k) es -k
            else if (inv.startsWith("+")) {
              start = start + parseFloat(inv.slice(1));
            } else if (inv.startsWith("√∑")) {
              start = start / parseFloat(inv.slice(1));
            } else if (inv.startsWith("√ó")) {
              start = start * parseFloat(inv.slice(1));
            } else if (inv === "√ó2") {
              start = start * 2;
            } else if (inv === "mitad") {
              start = start / 2;
            }
          });
          const guess = parseFloat(document.getElementById("startGuess").value);
          const okStart =
            !Number.isNaN(guess) && Math.abs(guess - start) < 1e-9;
          const msg =
            okOps && okStart
              ? `‚úÖ Correcto. Inicio = ${start}`
              : `‚ùå Revisa: ${
                  okOps ? "valor de inicio" : "inversas indicadas"
                }`;
          document.getElementById("solverMsg").textContent = msg;
        };
      }

      function renderCustom() {
        const html = `
        <p>Define tu problema:</p>
        <div class="grid-2">
          <label>Meta: <input id="c_goal" type="number" placeholder="p.ej., 40"></label>
          <label>Pasos (del √∫ltimo al primero): <textarea id="c_steps" rows="4" placeholder="Ejemplos de pasos finales\n+5\n√ó2\n-3\nmitad"></textarea></label>
        </div>
        <div class="divider"></div>
        <button id="build" class="primary">Construir y resolver</button>
        <div id="customHolder"></div>
      `;
        openModal("Creador de problema", html);
        document.getElementById("build").onclick = () => {
          const goal = parseFloat(document.getElementById("c_goal").value);
          const raw = document
            .getElementById("c_steps")
            .value.split(/\n+/)
            .map((s) => s.trim())
            .filter(Boolean);
          const steps = raw.map((s) => ({ op: s, inv: invertOp(s) }));
          const cfg = { title: "Personalizado", goal, steps };
          const mount = document.getElementById("customHolder");
          mount.innerHTML = `<div class="divider"></div><h4>Inversas detectadas</h4><ul>${steps
            .map((s) => `<li>${s.op} ‚Üí <code>${s.inv}</code></li>`)
            .join("")}</ul>`;
          // a√±adir solver
          const btn = document.createElement("button");
          btn.textContent = "Resolver ahora";
          btn.className = "primary";
          btn.onclick = () => renderSolver(cfg);
          mount.appendChild(btn);
        };
      }

      function invertOp(op) {
        op = op.replaceAll(" ", "");
        if (/^\+[0-9]+(\.[0-9]+)?$/.test(op)) return "-" + op.slice(1);
        if (/^-[0-9]+(\.[0-9]+)?$/.test(op)) return "+" + op.slice(1);
        if (/^√ó[0-9]+(\.[0-9]+)?$/.test(op)) return "√∑" + op.slice(1);
        if (/^√∑[0-9]+(\.[0-9]+)?$/.test(op)) return "√ó" + op.slice(1);
        if (op === "doble" || op === "√ó2") return "mitad";
        if (op === "mitad" || op === "√∑2") return "√ó2";
        return "¬øinversa?";
      }

      document.querySelectorAll(".problem .open").forEach((btn) => {
        btn.addEventListener("click", () => {
          const key = btn.closest(".problem").dataset.problem;
          if (key === "custom") return renderCustom();
          renderSolver(problems[key]);
        });
      });

      // ===== Quiz =====
      document.getElementById("grade").onclick = () => {
        let total = 0,
          ok = 0;
        document.querySelectorAll(".question").forEach((q) => {
          total++;
          const ans = q.dataset.answer;
          const sel = (q.querySelector("input[type=radio]:checked") || {})
            .value;
          if (sel === ans) {
            ok++;
            q.style.borderColor = "rgba(16,185,129,.6)";
          } else {
            q.style.borderColor = "rgba(239,68,68,.6)";
          }
        });
        document.getElementById(
          "score"
        ).textContent = `Resultado: ${ok}/${total}`;
        localStorage.setItem(
          "rbw-quiz",
          JSON.stringify({ ok, total, ts: Date.now() })
        );
      };
      document.getElementById("saveProgress").onclick = () => {
        const blob = new Blob([localStorage.getItem("rbw-quiz") || "{}"], {
          type: "application/json",
        });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "progreso_resolucion_inversa.json";
        a.click();
      };
      document.getElementById("loadProgress").onclick = () => {
        const inp = document.createElement("input");
        inp.type = "file";
        inp.accept = ".json,application/json";
        inp.onchange = () => {
          const file = inp.files[0];
          const fr = new FileReader();
          fr.onload = () => {
            try {
              const data = JSON.parse(fr.result);
              document.getElementById("score").textContent =
                data.ok != null
                  ? `Cargado: ${data.ok}/${data.total}`
                  : "Archivo inv√°lido";
            } catch (e) {
              alert("Archivo no v√°lido");
            }
          };
          fr.readAsText(file);
        };
        inp.click();
      };

      // ===== Export plantilla =====
      document.getElementById("exportJSON").onclick = () => {
        const tpl = {
          meta: "",
          pasos: [
            { op: "+k", inv: "-k" },
            { op: "√óm", inv: "√∑m" },
          ],
          notas: "Justifica cada inversi√≥n",
        };
        const blob = new Blob([JSON.stringify(tpl, null, 2)], {
          type: "application/json",
        });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "plantilla_trabajo_inverso.json";
        a.click();
      };

      // ===== Tema =====
      let dark = true;
      document.getElementById("toggleTheme").onclick = () => {
        dark = !dark;
        document.body.style.filter = dark
          ? "none"
          : "invert(1) hue-rotate(180deg)";
      };

      // ===== Modal util =====
      const modal = document.getElementById("modal");
      function openModal(title, html) {
        document.getElementById("modalTitle").textContent = title;
        document.getElementById("modalContent").innerHTML = html;
        modal.classList.add("show");
      }
      document.getElementById("closeModal").onclick = () =>
        modal.classList.remove("show");
      modal.addEventListener("click", (e) => {
        if (e.target === modal) modal.classList.remove("show");
      });
    </script>
  </body>
</html>
